<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" media="screen" href="../../css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" media="screen" href="../../css/dataTables.bootstrap.min.css">
    <link rel="stylesheet" type="text/css" media="screen" href="../../css/select.dataTables.min.css">
    <link rel="stylesheet" type="text/css" media="screen" href="../../layui/css/layui.css">
</head>
<body>
<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
    <br/>
    <form id="validateForm">
        <div class="widget-body no-padding">
            <table id="dt-table" class="table table-striped table-bordered table-hover" style="width:100%">
                <thead>
                <tr>
                </tr>
                <tr>
                    <th>Status</th>
                    <th>Reason</th>
                    <th>Date</th>
                    <th>Time</th>
                    <th>Time Code</th>
                    <th>City</th>
                    <th>State</th>
                    <th>Country</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <th style="width: 100px">
                        <select class="form-control input-sm" name="excelStatus"
                                data-bv-notempty='true' data-bv-notempty-message='状态 不能为空'>

                        </select>
                    </th>
                    <th style="width: 100px">
                        <select class="form-control input-sm" name="excelReason"
                                data-bv-notempty='true' data-bv-notempty-message='原因 不能为空'>

                        </select>
                    </th>
                    <th>
                        <input class="form-control" placeholder="date" type="text" name="excelDate"
                               data-bv-notempty='true' data-bv-notempty-message='日期 不能为空'>
                    </th>
                    <th><input class="form-control" placeholder="time" type="text" name="excelTime"
                               data-bv-notempty='true' data-bv-notempty-message='时间 不能为空'></th>
                    <th>
                        <input class="form-control" placeholder="zone" type="text" name="excelZone" value="08"
                               data-bv-notempty='true' data-bv-notempty-message='时区 不能为空'>
                    </th>
                    <th>
                        <input class="form-control" placeholder="city" type="text" name="excelCity"
                               style="text-transform:uppercase" data-bv-notempty='true' data-bv-notempty-message='城市 不能为空'>
                    </th>
                    <th>
                        <input class="form-control" placeholder="State" type="text" name="excelState"
                               style="text-transform:uppercase" data-bv-notempty='true'
                               data-bv-notempty-message='State 不能为空'></th>
                    <th>
                        <input class="form-control" placeholder="country" type="text" name="excelCountry"
                               style="text-transform:uppercase" data-bv-notempty='true' data-bv-notempty-message='国别 不能为空'>
                    </th>
                </tr>
                <tr>
                    <th style="width: 100px">
                        <select class="form-control input-sm" name="excelStatus"
                                data-bv-notempty='true' data-bv-notempty-message='状态 不能为空'>

                        </select>
                    </th>
                    <th style="width: 100px">
                        <select class="form-control input-sm" name="excelReason"
                                data-bv-notempty='true' data-bv-notempty-message='原因 不能为空'>

                        </select>
                    </th>
                    <th>
                        <input class="form-control" placeholder="date" type="text" name="excelDate"
                               data-bv-notempty='true' data-bv-notempty-message='日期 不能为空'>
                    </th>
                    <th><input class="form-control" placeholder="time" type="text" name="excelTime"
                               data-bv-notempty='true' data-bv-notempty-message='时间 不能为空'></th>
                    <th>
                        <input class="form-control" placeholder="zone" type="text" name="excelZone" value="08"
                               data-bv-notempty='true' data-bv-notempty-message='时区 不能为空'>
                    </th>
                    <th>
                        <input class="form-control" placeholder="city" type="text" name="excelCity"
                               style="text-transform:uppercase" data-bv-notempty='true' data-bv-notempty-message='城市 不能为空'>
                    </th>
                    <th>
                        <input class="form-control" placeholder="State" type="text" name="excelState"
                               style="text-transform:uppercase" data-bv-notempty='true'
                               data-bv-notempty-message='State 不能为空'></th>
                    <th>
                        <input class="form-control" placeholder="country" type="text" name="excelCountry"
                               style="text-transform:uppercase" data-bv-notempty='true' data-bv-notempty-message='国别 不能为空'>
                    </th>
                </tr>
                <tr>
                    <th style="width: 100px">
                        <select class="form-control input-sm" name="excelStatus"
                                data-bv-notempty='true' data-bv-notempty-message='状态 不能为空'>

                        </select>
                    </th>
                    <th style="width: 100px">
                        <select class="form-control input-sm" name="excelReason"
                                data-bv-notempty='true' data-bv-notempty-message='原因 不能为空'>

                        </select>
                    </th>
                    <th>
                        <input class="form-control" placeholder="date" type="text" name="excelDate"
                               data-bv-notempty='true' data-bv-notempty-message='日期 不能为空'>
                    </th>
                    <th><input class="form-control" placeholder="time" type="text" name="excelTime"
                               data-bv-notempty='true' data-bv-notempty-message='时间 不能为空'></th>
                    <th>
                        <input class="form-control" placeholder="zone" type="text" name="excelZone" value="08"
                               data-bv-notempty='true' data-bv-notempty-message='时区 不能为空'>
                    </th>
                    <th>
                        <input class="form-control" placeholder="city" type="text" name="excelCity"
                               style="text-transform:uppercase" data-bv-notempty='true' data-bv-notempty-message='城市 不能为空'>
                    </th>
                    <th>
                        <input class="form-control" placeholder="State" type="text" name="excelState"
                               style="text-transform:uppercase" data-bv-notempty='true'
                               data-bv-notempty-message='State 不能为空'></th>
                    <th>
                        <input class="form-control" placeholder="country" type="text" name="excelCountry"
                               style="text-transform:uppercase" data-bv-notempty='true' data-bv-notempty-message='国别 不能为空'>
                    </th>
                </tr>
                <tr>
                    <th style="width: 100px">
                        <select class="form-control input-sm" name="excelStatus"
                                data-bv-notempty='true' data-bv-notempty-message='状态 不能为空'>

                        </select>
                    </th>
                    <th style="width: 100px">
                        <select class="form-control input-sm" name="excelReason"
                                data-bv-notempty='true' data-bv-notempty-message='原因 不能为空'>

                        </select>
                    </th>
                    <th>
                        <input class="form-control" placeholder="date" type="text" name="excelDate"
                               data-bv-notempty='true' data-bv-notempty-message='日期 不能为空'>
                    </th>
                    <th><input class="form-control" placeholder="time" type="text" name="excelTime"
                               data-bv-notempty='true' data-bv-notempty-message='时间 不能为空'></th>
                    <th>
                        <input class="form-control" placeholder="zone" type="text" name="excelZone" value="08"
                               data-bv-notempty='true' data-bv-notempty-message='时区 不能为空'>
                    </th>
                    <th>
                        <input class="form-control" placeholder="city" type="text" name="excelCity"
                               style="text-transform:uppercase" data-bv-notempty='true' data-bv-notempty-message='城市 不能为空'>
                    </th>
                    <th>
                        <input class="form-control" placeholder="State" type="text" name="excelState"
                               style="text-transform:uppercase" data-bv-notempty='true'
                               data-bv-notempty-message='State 不能为空'></th>
                    <th>
                        <input class="form-control" placeholder="country" type="text" name="excelCountry"
                               style="text-transform:uppercase" data-bv-notempty='true' data-bv-notempty-message='国别 不能为空'>
                    </th>
                </tr>
                <tr>
                    <th style="width: 100px">
                        <select class="form-control input-sm" name="excelStatus"
                                data-bv-notempty='true' data-bv-notempty-message='状态 不能为空'>

                        </select>
                    </th>
                    <th style="width: 100px">
                        <select class="form-control input-sm" name="excelReason"
                                data-bv-notempty='true' data-bv-notempty-message='原因 不能为空'>

                        </select>
                    </th>
                    <th>
                        <input class="form-control" placeholder="date" type="text" name="excelDate"
                               data-bv-notempty='true' data-bv-notempty-message='日期 不能为空'>
                    </th>
                    <th><input class="form-control" placeholder="time" type="text" name="excelTime"
                               data-bv-notempty='true' data-bv-notempty-message='时间 不能为空'></th>
                    <th>
                        <input class="form-control" placeholder="zone" type="text" name="excelZone" value="08"
                               data-bv-notempty='true' data-bv-notempty-message='时区 不能为空'>
                    </th>
                    <th>
                        <input class="form-control" placeholder="city" type="text" name="excelCity"
                               style="text-transform:uppercase" data-bv-notempty='true' data-bv-notempty-message='城市 不能为空'>
                    </th>
                    <th>
                        <input class="form-control" placeholder="State" type="text" name="excelState"
                               style="text-transform:uppercase" data-bv-notempty='true'
                               data-bv-notempty-message='State 不能为空'></th>
                    <th>
                        <input class="form-control" placeholder="country" type="text" name="excelCountry"
                               style="text-transform:uppercase" data-bv-notempty='true' data-bv-notempty-message='国别 不能为空'>
                    </th>
                </tr>
                </tbody>
            </table>
        </div>
    </form>
    <form class="form-horizontal" id="form" method="post" action="/shipper/exportExcelICT" onsubmit="return false"
          enctype="multipart/form-data">
        <input id="token" name="token" hidden="true">
        <input id="actualDate" name="actualDate" hidden="true">
        <input id="hawb" name="hawb" hidden="true">
        <input id="awb" name="awb" hidden="true">
        <input id="shipmentway" name="shipmentway" hidden="true">
        <input id="truckNo" name="truckNo" hidden="true">
        <input id="arrayId" name="arrayId" hidden="true">
        <input id="exportStatus" name="exportStatus" hidden="true">
        <input id="exportDate" name="exportDate" hidden="true">
        <input id="exportReason" name="exportReason" hidden="true">
        <input id="exportTime" name="exportTime" hidden="true">
        <input id="exportZone" name="exportZone" hidden="true">
        <input id="exportCity" name="exportCity" hidden="true">
        <input id="exportState" name="exportState" hidden="true">
        <input id="exportCountry" name="exportCountry" hidden="true">
        <div class="form-actions">
            <div class="row" align="center">
                <div class="col-md-12">
                    <button class='btn btn-primary' type="submit" onclick="exportExcel(this)">
                        <i class='layui-icon'>&#xe601;</i>导出
                    </button>
                </div>
            </div>
        </div>
    </form>
</div>

<script type="text/javascript" src="../../js/libs/jquery-2.1.1.min.js"></script>
<script type="text/javascript" src="../../js/jq.js"></script>
<script type="text/javascript" src="../../layui/layui.js"></script>
<script type="text/javascript" src="../../js/common.js"></script>
<script type="text/javascript" src="../../js/dict.js"></script>
<script type="text/javascript" src="../../js/plugin/datatables/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="../../js/plugin/datatables/dataTables.select.min.js"></script>
<script type="text/javascript" src="../../js/plugin/datatables/dataTables.bootstrap.min.js"></script>
<script type="text/javascript" src="../../js/plugin/bootstrapvalidator/bootstrapValidator.min.js"></script>
<script type="text/javascript">
    var example;

    initData();

    function initUrlData() {
        var actualDate = getUrlParam("actualDate");
        var hawb = getUrlParam("hawb");
        var awb = getUrlParam("awb");
        var shipmentway = getUrlParam("shipmentway");
        var truckNo = getUrlParam("truckNo");
        var arrayMid = getUrlParam("arrayMid");
        $("#actualDate").val(actualDate);
        $("#hawb").val(hawb);
        $("#awb").val(awb);
        $("#shipmentway").val(shipmentway);
        $("#truckNo").val(truckNo);
        $("#arrayId").val(arrayMid);
    }

    function initData() {
        initUrlData();

        showDictSelectByName("excelStatus", "exportState", true);
        showDictSelectByName("excelReason", "exportReason", true);
        $('[name="excelDate"]').val(getCurrentDate("date"));
        $('[name="excelTime"]').val(getCurrentDate("time"));
    }

    function showDictSelectByName(id, name, all) {
        var data = getDictByName(name);
        var select = $('[name=' + id + ']');
        select.empty();

        if (all != undefined && all) {
            select.append("<option value=''>全部</option>");
        }

        $.each(data, function (k, v) {
            select.append("<option value ='" + k + "'>" + v + "</option>");
        });

        return data;
    }

    function getCurrentDate(format) {
        var now = new Date();
        var year = now.getFullYear(); //得到年份
        var month = now.getMonth();//得到月份
        var date = now.getDate();//得到日期
        var hour = now.getHours();//得到小时
        var minu = now.getMinutes();//得到分钟
        month = month + 1;
        if (month < 10) month = "0" + month;
        if (date < 10) date = "0" + date;
        if (hour < 10) hour = "0" + hour;
        if (minu < 10) minu = "0" + minu;
        var time = "";
        //精确到天
        if (format == 'date') {
            time = year + '' + month + '' + date;
        }
        //精确到分
        else if (format == 'time') {
            time = hour + '' + minu;
        }
        return time;
    }

    var pro = window.location.protocol;
    var host = window.location.host;
    var domain = pro + "//" + host;

    var layedit, index;
    layui.use('layedit', function () {
        layedit = layui.layedit;
        layedit.set({
            uploadImage: {
                url: '/files/layui?domain=' + domain + "&token=" + localStorage.getItem("token"),
                type: 'post'
            }
        });
        index = layedit.build('demo');
    });


    function exportExcel(obj) {
        $('#validateForm').bootstrapValidator();
        var bootstrapValidator = $("#validateForm").data('bootstrapValidator');
        bootstrapValidator.validate();
        if (!bootstrapValidator.isValid()) {
            return;
        }
        var excelStatusArr = new Array(5);
        $("[name='excelStatus']").each(function (j, item) {
            excelStatusArr[j] = item.value
        });
        $("#exportStatus").val(excelStatusArr.join(","));

        var excelDateArr = new Array(5);
        $("[name='excelDate']").each(function (j, item) {
            excelDateArr[j] = item.value
        });
        $("#exportDate").val(excelDateArr.join(","));

        var excelReasonArr = new Array(5);
        $("[name='excelReason']").each(function (j, item) {
            excelReasonArr[j] = item.value
        });
        $("#exportReason").val(excelReasonArr.join(","));

        var excelTimeArr = new Array(5);
        $("[name='excelTime']").each(function (j, item) {
            excelTimeArr[j] = item.value
        });
        $("#exportTime").val(excelTimeArr.join(","));

        var excelZoneArr = new Array(5);
        $("[name='excelZone']").each(function (j, item) {
            excelZoneArr[j] = item.value
        });
        $("#exportZone").val(excelZoneArr.join(","));

        var excelCityArr = new Array(5);
        $("[name='excelCity']").each(function (j, item) {
            excelCityArr[j] = item.value
        });
        $("#exportCity").val(excelCityArr.join(","));

        var excelStateArr = new Array(5);
        $("[name='excelState']").each(function (j, item) {
            excelStateArr[j] = item.value
        });
        $("#exportState").val(excelStateArr.join(","));

        var excelCountryArr = new Array(5);
        $("[name='excelCountry']").each(function (j, item) {
            excelCountryArr[j] = item.value
        });
        $("#exportCountry").val(excelCountryArr.join(","));
        $("#token").val(localStorage.getItem("token"));
        $("#form").attr("onsubmit", "return true");
        $("#form")[0].submit();//解决bootstrapValidator 表单无法提交的问题
        $("#form").attr("onsubmit", "return false");
    }

</script>
</body>
</html>